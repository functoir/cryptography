\begin{problem}
Consider the affine cipher with $\calP=\calC=\Z/n\Z$.  
\begin{enumerate}\renewcommand{\itemsep}{3mm}
\item Suppose $n=541$ and we take the key $(a,b)=(34,71)$.  Encrypt the plaintext $m=204$, and decrypt the ciphertext $c=431$.
\begin{Answer}

\noindent
The encryption of $m=204$ is $515$
\begin{align*}
  c &= a \cdot p + b \crim{\pmod n}\\
  &= 34 \cdot 204 + 71 \crim{\pmod{541}}\\
  &= 7007 \crim{\pmod{541}}\\
  &= 515 \crim{\pmod{541}}
\end{align*}

\noindent
The decryption of $c=431$ is $297$
\begin{align*}
  c &\equiv a \cdot p + b \crim{\pmod n}\\
  431 &\equiv 34p + 71 \crim{\pmod{541}}\\
  360 &\equiv 34p \crim{\pmod{541}}\\
  p &= \frac{360 + 541k}{34}  \hspace{15pt}\mid p,k \in \Z^+\\
  p &= \frac{360 + 541\cdot 18}{34}\\
  p &= 297
\end{align*}

\end{Answer}

\item Eve intercepts a ciphertext from Alice
and through espionage she learns that the letter
$x \in \calP$ is encrypted as $y \in \calC$ in this message.
Show that Eve can decrypt the message using $O(n)$ trials.  
\begin{Answer}

Suppose Eve knows that a letter $x \in \calP$ is encrypted as
$y \in \calC$ in the message.

\noindent
Then, Eve knows that \crim{$a \cdot x + b \pmod n \equiv y \pmod n$} for some $a, b \in \Z/n\Z$.

\noindent $(a, b)$ also happen to be the keys to the Affine Cipher.
where $(a, b)$ are the keys of the affine cipher.

\begin{align*}
  ax + b &\equiv y \pmod n\\
  ax + b &= y + kn\\
  ax + kn = y - b\\
\end{align*}

\noindent
We can safely assume that $0 \le b \le n-1$ 
(since adding any number $x \ge n$ is equivalent to adding
$x \mod n$).

\noindent
We can therefore iterate through all the possible values of $b$ and
test for a matching value for $a$ that, when plugged into the affine cipher
maps the known plaintext letter to the known (and correct) ciphertext letter.

\end{Answer}
\item Now suppose that (contrary to Kerckhoffs's principle) the integer $n$ is not public knowledge.
Is the affine cipher still vulnerable if Eve manages to steal a plaintext/ciphertext pair?
How might Eve break the system?
\begin{Answer}
  
Without knowing $n$, the problem becomes much harder to break.
Sure, Eve can iterate up from $0$ and attempt to check integers until she finds a match,
but not knowing the base means the correct key can be missed when taking the modulus to a wrong value of $n$.

\noindent
A possible way would be to estimate values of $n$ using 

\end{Answer}
\end{enumerate}
\end{problem}

