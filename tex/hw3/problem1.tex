\begin{problem}
Consider the affine cipher with $\calP=\calC=\Z/n\Z$.  
\begin{enumerate}\renewcommand{\itemsep}{3mm}
\item Suppose $n=541$ and we take the key $(a,b)=(34,71)$.  Encrypt the plaintext $m=204$, and decrypt the ciphertext $c=431$.
\begin{Answer}

\noindent
The encryption of $m=204$ is $515$
\begin{align*}
  c &= a \cdot p + b \crim{\pmod n}\\
  &= 34 \cdot 204 + 71 \crim{\pmod{541}}\\
  &= 7007 \crim{\pmod{541}}\\
  &= 515 \crim{\pmod{541}}
\end{align*}

\noindent
The decryption of $c=431$ is $297$
\begin{align*}
  c &\equiv a \cdot p + b \crim{\pmod n}\\
  431 &\equiv 34p + 71 \crim{\pmod{541}}\\
  360 &\equiv 34p \crim{\pmod{541}}\\
  p &= \frac{360 + 541k}{34}  \hspace{15pt}\mid p,k \in \Z^+\\
  p &= \frac{360 + 541\cdot 18}{34}\\
  p &= 297
\end{align*}

\end{Answer}

\item Eve intercepts a ciphertext from Alice
and through espionage she learns that the letter
$x \in \calP$ is encrypted as $y \in \calC$ in this message.
Show that Eve can decrypt the message using $O(n)$ trials.  
\begin{Answer}

Suppose we know that a letter $p \in \calP$ is encrypted as
$c \in \calC$ in the message.

\noindent
Then, we know that \crim{$a \cdot p + b \pmod n \equiv c \pmod n$},
where $(a, b)$ are the keys of the affine cipher.

\noindent
We can safely assume that $0 \le b \le n-1$ 
(since adding any number $x \ge n$ is equivalent to adding
$x \mod n$).

\noindent
We can therefore iterate through all the possible values of $b$ and
test for a matching value for $a$ that, when plugged into the affine cipher
maps the known plaintext letter to the known (and correct) ciphertext letter.

\end{Answer}
\item Now suppose that (contrary to Kerckhoffs's principle) the integer $n$ is not public knowledge.  Is the affine cipher still vulnerable if Eve manages to steal a plaintext/ciphertext pair?  How might Eve break the system?
\begin{Answer}
  
\end{Answer}
\end{enumerate}
\end{problem}

